# MAC address(Media Access Control Address)

역할: MAC 주소는 네트워크 인터페이스 컨트롤러(NIC) 또는 네트워크 어댑터의 물리적 하드웨어 주소를 식별하는 데 사용. 즉, MAC 주소는 네트워크에서 장치를 유일하게 식별할 수 있게 해줌  
계층: MAC 주소는 데이터 링크 계층(Layer 2, OSI 모델의 2계층)에서 작동.  
형식: MAC 주소는 일반적으로 48비트(6바이트) 길이로 표현되며, 12자리 16진수로 구성됨. 예시: 00:1A:2B:3C:4D:5E 또는 00-1A-2B-3C-4D-5E.

<img width="500" alt="스크린샷 2024-08-26 오후 9 08 11" src="https://github.com/user-attachments/assets/0d75a25f-4b74-4586-be5b-43e096c09ee0">

# IP address(Internet Protocol Address)

역할: IP 주소는 인터넷 또는 로컬 네트워크에서 장치를 논리적으로 식별하는 데 사용. IP 주소는 네트워크 간의 데이터 패킷 전달을 관리함  
계층: IP 주소는 네트워크 계층(Layer 3, OSI 모델의 3계층)에서 작동힘  
형식:

- IPv4: 32비트 길이로, 네 개의 8비트 숫자로 표현. 각 숫자는 0에서 255 사이의 값을 가질 수 있음. 예시: 192.168.1.1.
- IPv6: 128비트 길이로, 8개의 16비트 숫자가 콜론(:)으로 구분. 예시: 2001:0db8:85a3:0000:0000:8a2e:0370:7334.

IPv6 주소 2001:0db8:85a3:0000:0000:8a2e:0370:7334를 2진수로 변환하면

```
0010 0000 0000 0001
0000 1101 1011 1000
1000 0101 1010 0011
0000 0000 0000 0000
0000 0000 0000 0000
1000 1010 0010 1110
0000 0011 0111 0000
0111 0011 0011 0100
```

으로 이 전체 변환이 128비트가 된다.

<img width="500" alt="스크린샷 2024-08-26 오후 9 21 24(2)" src="https://github.com/user-attachments/assets/9033ad01-7996-424f-ab8f-e3191358236c">

# IP와 MAC의 규칙적인 네트워크 설정 방법

- 네트워크 설정에 일관성을 부여하면, 전체 네트워크 관리가 더 쉬워진다. 특정 규칙(예: IP 주소와 MAC 주소의 끝자리를 일치시키기)

```
IP 주소 192.168.0.100
MAC 주소 00:000:100
```

위의 예시처럼 마지막 숫자 100을 맞추는 이유는 새로운 장비를 추가하거나 변경할 때 동일한 규칙을 따라 추가하면 되므로 네트워크 관리의 일관성이 유지됨

---

# issue

공장의 네트워크를 가동하면, 사무실 인터넷이 느려지다가 결국 인터넷이 끊기는 현상이 발생

# 원인 파악

1. 네트워크 혼잡(Network Congestion)  
   사무실 공유기에 공장동 인터넷 라인을 추가해 Network Congestion이 발생한것으로 유추  
   두 네트워크 간 트래픽이 하나의 네트워크에 집중되고 있음.  
   공장동에서 컨트롤러로 초당 수백번의 데이터 전송 및 여러 장치 연결로 인해 대역폭을 많이 사용하여 사무실 네트워크의 가용 대역폭이 줄어들어 인터넷 속도 감소

2. 브로드캐스트 도메인  
   동일한 네트워크에 많은 장치가 연결되면 브로드캐스트 트래픽(네트워크 상 모든 장치가 수신하는 트래픽)이 증가하는 현상이 발생함  
   이는 전체 네트워크 성능에 악영향을 끼칠 수 있음  
   공장동과 사무실 장치들이 같은 네트워크에 연결되어 있다면, 사무실의 네트워크가 브로드 캐스트 트래픽으로 인해 영향을 받게 됨

3. IP 충돌  
   동일한 네트워크에 많은 장치가 IP 주소를 공유하려고 할 경우 IP 주소 충돌이 발생해 네트워크 연결 문제를 일으킬 수 있음

# 해결 방법

## 1. 네트워크 분리

1-1. VLAN이란
Virtual Lan(VLan)을 사용하여 사무실 네트워크와 공장동 네트워크를 분리하여 두 네트워크 간 트래픽이 하나의 네트워크에 집중되는 것을 방지함

```
VLAN이란 네트워크 스위치에서 논리적으로 네트워크를 분리하여 동일한 물리적 네트워크 장비를 사용하면서 별도의 네트워크처럼 동작하게 만드는 기술
물리적으로 분리된 것이 아닌 논리적으로 분리된 상태로 만드는 것
```

1-2. VLAN을 사용한 네트워크 분리

- 사무실 네트워크 VLAN: 사무실 네트워크에 속한 장치들은 특정 VLAN에 속하도록 설정함. 이 VLAN은 사무실 네트워크의 트래픽을 관리하고, 공장동의 네트워크 트래픽과 분리함.
- 공장동 네트워크 VLAN: 공장동 네트워크 장치들도 별도의 VLAN에 속하도록 설정함. 이 VLAN은 공장동의 네트워크 트래픽을 관리하고, 사무실 네트워크 트래픽과 분리함.

1-3. 이점

- 트래픽 격리: 사무실 네트워크와 공장동 네트워크 간의 트래픽이 분리되어 서로 간섭하지 않게 되어 네트워크 성능을 향상시킬 수 있음
- 보안 강화: 각 네트워크가 논리적으로 분리되므로, 한 네트워크에서 발생하는 문제(예: 악성 트래픽)가 다른 네트워크로 전파되는 것을 방지할 수 있게됨
- 브로드캐스트 도메인 축소: 각 VLAN은 별도의 브로드캐스트 도메인을 가지므로, 브로드캐스트 트래픽이 다른 VLAN으로 전파되지 않음

1-4. 방법

ipTIME과 같은 공유기에서 VLAN 기능을 활용하여 네트워크를 분리할 수 있음

```
1. VLAN 설정: 공유기의 관리 페이지에 접속하여, VLAN 설정 메뉴로 이동
2. 사무실 네트워크 VLAN 설정: 사무실 네트워크에 연결된 포트들을 하나의 VLAN으로 설정
3. 공장동 네트워크 VLAN 설정: 공장동 네트워크에 연결된 포트들을 다른 VLAN으로 설정
4. 인터넷 연결 분리: 각 VLAN이 인터넷에 독립적으로 연결되도록 라우팅 설정을 조정하면서 테스트
```

1-5. AWS VPC (Virtual Private Cloud)와 비교

VLAN (Virtual Local Area Network)과 AWS VPC (Virtual Private Cloud)는 모두 네트워크를 논리적으로 분리하는 기술로 비슷하게 보일 수 있다.

VPC는 AWS 클라우드 내에서 가상의 네트워크를 생성하여, 사용자가 자신의 네트워크 설정을 완벽하게 제어할 수 있게 만든다.  
서브넷, 라우팅 테이블, 인터넷 게이트웨이 등을 설정하여 VPC 내의 네트워크 트래픽을 관리할 수 있다.

- VLAN: 물리적 네트워크 인프라에서 사용한다.
- VPC: 클라우드 환경에서 가상 네트워크를 생성하고 관리한다.

1-6. AWS VPC 내에서 네트워크 분리

- 서브넷(Subnet): VPC 내에서 서브넷을 사용하여 논리적으로 네트워크를 분리할 수 있다. 예를 들어, 사무실용 서브넷과 공장동용 서브넷을 각각 생성하여 분리시킨다.
- 보안 그룹(Security Group) 및 네트워크 ACL: 각 서브넷에 대해 보안 그룹과 네트워크 ACL을 설정하여, 특정 서브넷 간의 트래픽을 제어하고, 외부로부터의 접근을 제한할 수 있음

1-7. 서브넷을 통안 분리

- 사무실 서브넷: 사무실에 위치한 서버, 서비스, 장치들을 이 서브넷에 할당 그리고 이 서브넷은 사무실 네트워크와 연계된 모든 리소스를 포함
- 공장동 서브넷: 공장동에 위치한 서버, 서비스, 장치들을 이 서브넷에 할당 그리고 이 서브넷은 공장동 네트워크와 연계된 모든 리소스를 포함

그 외 보안그룹, ACL, 게이트웨이, 라우팅 테이블 등으로 세밀한 설정이 가능하다.

```
VPC: CompanyVPC
├── 사무실 서브넷 (Office Subnet)
│   ├── 서버 A (Office Server A)
│   └── 서버 B (Office Server B)
└── 공장동 서브넷 (Factory Subnet)
    ├── 서버 C (Factory Server C)
    └── 서버 D (Factory Server D)
```

## 2. QoS (Quality of Service) 설정을 통해 네트워크 대역폭을 우선순위에 따라 관리

2-1. QoS (Quality of Service)란

QoS는 네트워크 트래픽을 관리하여 특정 서비스나 트래픽 유형에 우선순위를 부여하는 기술

2-2. Why?

- 트래픽 우선순위 설정 : 사무실 네트워크에 우선순위 부여: QoS 설정을 통해 사무실 네트워크에 우선순위를 부여하면, 사무실에서 발생하는 트래픽이 항상 공장동 트래픽보다 먼저 처리하게 됨
- 대역폭 할당 : 사무실 네트워크에 70%의 대역폭을 할당하고, 공장동 네트워크에 30%를 할당하면, 사무실에서 발생하는 트래픽이 우선적으로 처리하게 됨
- 트래픽 과부하 관리 : QoS 없이 두 네트워크가 동일한 대역폭을 공유하게 되면, 공장 네트워크로 인해 사무실 네트워크도 대역폭에 영향을 받게되는데, QoS 설정하면 안정적인 대역폭 유지 가능

2-3. How?

```
1. ipTIME 공유기 설정 페이지에 접속
2. 공유기 관리 페이지에서 고급 설정 > QoS 설정
3. 사무실 네트워크에 더 높은 대역폭을 할당하여, 네트워크 자원을 우선적으로 사용
4. 나머지 대역폭을 공장동에 할당하여 후순위로 만듦
5. 저장 및 적용
```

2-4. AWS에서 사용하는 비슷한 서비스

AWS Elastic Load Balancing(ELB)는 들어오는 트래픽을 여러 대상(예: EC2 인스턴스)으로 분산하여 네트워크 부하를 관리하는 서비스이다.  
트래픽을 균형있게 분산하여 특정 서비스나 애플리케이션에 부하가 집중되는 것을 방지한다.

2-5. ELB와 서브넷을 이용한 트래픽 처리

시나리오1. 사무동과 공장동 로드밸런서를 독립적으로 처리

```
서브넷 구성:
사무동 서브넷: 사무동의 네트워크 트래픽을 처리하는 서브넷을 설정
공장동 서브넷: 공장동의 네트워크 트래픽을 처리하는 서브넷을 설정

ELB 설정:
각 서브넷에 연결된 ELB: 사무동 서브넷과 공장동 서브넷에 각각 ELB를 설정하여, 각 서브넷에서 발생하는 트래픽을 해당 서브넷 내의 리소스로 분산
트래픽 라우팅: ELB는 들어오는 트래픽을 분석하고, 적절한 서브넷의 리소스에 트래픽을 전달(예를 들어, 사무동의 트래픽은 사무동 서브넷에 있는 EC2 인스턴스로, 공장동의 트래픽은 공장동 서브넷에 있는 EC2로 전달)
```

시나리오2. 공용 ELB 설정하여 서브넷을 통해 분산

```
사무동과 공장동의 트래픽을 하나의 ELB를 통해 처리하되, 서브넷을 통해 트래픽을 분리
ELB는 서브넷 별로 트래픽을 분산시켜, 사무동 트래픽은 사무동 서브넷의 인스턴스로, 공장동 트래픽은 공장동 서브넷의 인스턴스로 전달되도록 설정
```
